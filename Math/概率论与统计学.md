[toc]

# 约定
有时以下面的这种写法表示多维随机变量:  
多维随机变量的列向量形式：`$X=(X_1,X_2,\cdots,X_n)$`  
多维随机变量的行向量形式：`$X=(X_1,X_2,\cdots,X_n)^T$`  

另外在**矩阵论**章节中的约定，同样适用于这一部分


# 基本定律

### 大数定律

### 中心极限定理


### 抽样分布定理
设`$X_1,X_2, \cdots,X_n$`是正态总体`$N(\mu,\sigma^2)$`的样本，`$\bar{X},S^2$`分别为样本均值和样本方差，则有
1. `$\bar{X}$`和`$S^2$`相互独立；
2. `$\bar{X} \sim N(\mu, \frac{\sigma^2}{n})$`
3. `$\frac{(n-1)}{\sigma^2}S^2 \sim \chi^2(n-1)$`
4. `$\frac{\bar{X}-\mu}{S/\sqrt{n}} \thicksim t(n-1)$`


# 随机变量的数字特征

#### 数学期望的性质：
1. 设`$C$`是常数，则有`$E(C)=C$`
2. 设`$X$`是随机变量，`$C$`是常数，则`$E(CX)=CX$`
3. 设`$X,Y$`是两个随机变量，则有 `$E(X+Y)=E(X)+E(Y)$`
4. 设`$X,Y$`是相互独立的随机变量，则有 `$E(XY)=E(X)E(Y)$`

#### 方差的性质
1. `$D(X)=E(X^2)-[E(X)]^2$`
2. 设`$C$`为常数，则`$D(C)=0$`
3. 设随机变量`$X$`的方差存在，`$C$`是常数，有`$D(CX)=C^2D(X)$`
4. 设随机变量`$X,Y$`的方差存在，有`$D(X \pm Y) = D(X) + D(Y) \pm 2E\{[X-E(X)][Y-E(Y)]\}$`

#### 协方差
```math
\mathrm{Cov}(X,Y) = E\{[X-E(X)][Y-E(Y)]\}
```
**性质：**  
```math
\begin{aligned}
&\mathrm{Cov}(X,Y) = \mathrm{Cov}(Y,X) \\
&\mathrm{Cov}(aX+b, cY+D) = ac\mathrm{Cov}(X,Y)  \\
&\mathrm{Cov}(X_1+X_2,Y) = \mathrm{Cov}(X_1,Y)+\mathrm{Cov}(X_2,Y)  \\
&\mathrm{Cov}(X,Y) = E(XY) - E(X)E(Y)  \\
&\mathrm{Cov}(X,X) = \mathrm{var}(X)  \\
\end{aligned}
```

##### 协方差矩阵

对于`$m$`维和`$n$`维随机变量: `$X=(X_1,\cdots,X_m), Y=(Y_1,\cdots,Y_n)$`，注意按照约定这是列向量的形式，或者按照**矩阵论**章节的约定来写：
```math
X = \begin{bmatrix}X_1\\X_2\\\vdots\\ X_m\end{bmatrix}

Y = \begin{bmatrix}Y_1\\ Y_2\\ \vdots\\ Y_n\end{bmatrix}
```
`$X_i$`或`$Y_i$`表示某个一维的随机变量。
`$\mathrm{Cov}(X,Y)$`是一个`$m\times n$`矩阵，其中
```math
\mathrm{Cov}(X,Y) = E\{[X-E(X)][Y-E(Y)]\}

[\mathrm{Cov}(X,Y)]_{ij} = \mathrm{Cov}(X_i,Y_j)
```


**性质：**  
```math
\mathrm{Cov}(X,Y) = \mathrm{Cov}(Y,X)^T

\mathrm{Cov}(AX+b,Y) = A\mathrm{Cov}(X,Y)

\mathrm{Cov}(X+Y,Z) = \mathrm{Cov}(X,Z) + \mathrm{Cov}(Y,Z)

\mathrm{Var}(X) = \mathrm{Cov}(X,X)

\forall a\in  R^n,\quad \mathrm{Var}(a^TX) = a^T\mathrm{Var}(X)a

\forall A \in R^{k\times n},\quad \mathrm{Var}(AX) = A\mathrm{Var}(X)A^T
```


对于方差矩阵：
```math
\rm{Var}(X)=\rm{Cov}(X,X) = E[(X-\mu)(X-\mu)^T] = E[XX^T] - \mu\mu^T
```
注意上面的`$X$`和`$\mu$`都是随机变量的列向量。

对于样本数据`$X$`，计算样本方差矩阵，用矩阵可以如下表示：  
设`$X$`的形式为，每行是一个样本，每列是一个随机变量（特征），设有`$N$`个样本，`$d$`个特征，`$X$`为`$N\times d$`矩阵：
```math
X = \begin{bmatrix}x_1^1 & x_2^1 & \cdots & x_d^1 \\
                   x_1^2 & x_2^2 & \cdots & x_d^2 \\ &&\cdots&\\
                   x_1^N & x_2^N & \cdots & x_d^N \\ \end{bmatrix}

```

样本均值为`$\hat{X}$`，是每个特征的`$N$`个样本各自求均值得到。`$\hat{X}$`依然是一个`$N\times d$`矩阵，只不过每一列的值是相等的（也就是该列所在的随机变量的样本均值）。

样本方差矩阵为：
```math
S = \frac{1}{N-1}(X-\hat{X})^T(X-\hat{X})
```



# 常用分布





## 伽马分布

**伽马函数：**  
```math
\Gamma(\alpha) = \int_0^{+\infty}t^{\alpha-1}e^{-t}dt, \quad \alpha > 0
```
性质：  
```math
\begin{aligned}
\Gamma(\alpha + 1)
&= \int_0^\infty t^\alpha e^{-t}dt 
\\&= -\int_0^\infty t^\alpha d(e^{-t})
\\&= -\left[t^\alpha e^{-t} \mid_0^\infty - \alpha\int_0^\infty e^{-t}t^{\alpha-1}dt \right]
\\&= \alpha \Gamma(\alpha)
\end{aligned}
```
另外：
```math
\Gamma(n+1) = n\Gamma(n) = n!

\Gamma(\frac{1}{2}) = \sqrt{\pi}
```

**伽马分布：**  

令`$t=\frac{x}{\beta}$`
```math
\begin{aligned}
\Gamma(\alpha) &= \int_0^\infty (\frac{x}{\beta})^{\alpha-1}e^{-\frac{x}{\beta}}d\frac{x}{\beta}
\end{aligned}
```
可得：
```math
\begin{aligned}
\int_0^\infty \frac{1}{\Gamma(\alpha)\beta^\alpha}x^{\alpha-1}e^{-\frac{x}{\beta}}dx = 1
\end{aligned}
```
由于`$\alpha >0 ,\beta >0 ,\Gamma(\alpha) > 0$`，对`$x$`求导，得到密度函数：
```math
f(x) = \begin{cases} \frac{1}{\Gamma(\alpha)\beta^\alpha}x^{\alpha -1}e^{-\frac{x}{\beta}}, \quad 0 < x < +\infty \\ 0, \quad x \le 0 \end{cases}

```
于是得到伽马分布的累计分布函数：
```math
F(x;\alpha,\beta) = \int_0^\infty \frac{x^{\alpha-1}}{\Gamma(\alpha)\beta^\alpha}e^{-\frac{x}{\beta}}dx
```
概率密度函数为：
```math
f(x;\alpha,\beta) = \frac{x^{\alpha-1}e^{-\frac{x}{\beta}}}{\Gamma(\alpha)\beta^\alpha}
```
设`$\beta = \frac{1}{\lambda}$`
则可以改写为：
```math
\Gamma(\alpha,\lambda) = \int_0^\infty \frac{\lambda^\alpha x^{\alpha-1}}{\Gamma(\alpha)}e^{-\lambda x}dx
```
期望：`$E = \frac{\alpha}{\lambda} = \alpha \beta$`  
方差：`$D = \frac{\alpha}{\lambda^2} = \alpha \beta^2$`  
`$\alpha$`为形状参数，主要决定了分布曲线的形状，`$\beta$`为尺度参数，主要决定了曲线有多陡峭。

1. 当`$\alpha = 1$`时，为指数分布  
密度函数：
```math
f(x) = \begin{cases}\lambda e^{-\lambda x}, \quad x>0 \\ 0, \quad x\le 0\end{cases}
```
累计分布函数：  
```math
F(x) = \begin{cases}1 - e^{-\lambda x}, \quad x>0 \\ 0, \quad x\le 0\end{cases}
```
2. 令`$\alpha=\frac{n}{2},\beta=2$`则为`$\chi^2$`分布
```math
F(x) = \int_0^\infty \frac{1}{\Gamma(\frac{n}{2})2^{\frac{n}{2}}}x^{\frac{n}{2}-1}e^{-\frac{x}{2}}dx
```

### 卡方分布的性质
**定理：**  
设`$n$`个相互独立，并且都服从正态分布`$N(0,1)$`的随机变量`$X_1,X_2, \cdots, X_n$`，记：
```math
\chi^2 = \sum\limits_{i=1}^n X_i^2
```
则随机变量`$\chi^2$`服从自由度为`$n$`的`$\chi^2$`分布。

**性质1：**
```math
E(\chi^2) = n

D(\chi^2) = 2n
```
**性质2：**  
设`$Y_1,Y_2$`相互独立，且`$Y_1\sim\chi^2(n_1), Y_2\sim\chi^2(n_2)$`，则有
```math
Y_1+ Y_2 \sim \chi^2(n_1+n_2)
```


## 贝塔分布

**beta函数：**  
```math
B(P,Q) = \int_0^1x^{P-1}(1-x)^{Q-1}dx, \quad P,Q>0
```
性质：
```math
B(P,Q) = B(Q,P)

B(P,Q) = \frac{\Gamma(P)\Gamma(Q)}{\Gamma(P+Q)}

B(P, 1-P) = \Gamma(P)\Gamma(1-P)
```
不完全beta函数：
```math
B(x;P,Q) = \int_0^x x^{P-1}(1-x)^{Q-1}dx
```

**beta分布：**  

beta分布的累计分布函数：
```math
F(x;\alpha,\beta) = \frac{B(x;\alpha,\beta)}{B(\alpha,\beta)}
```
概率密度函数：
```math
\begin{aligned}
f(x;\alpha,\beta) &= \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}x^{\alpha-1}(1-x)^{\beta-1}
\\&=\frac{1}{B(\alpha,\beta)}x^{\alpha-1}(1-x)^{\beta-1}
\end{aligned}
```

众数：`$\frac{\alpha-1}{\alpha+\beta-2}$`  
期望：`$\frac{\alpha}{\alpha+\beta}$`  
方差：`$\frac{\alpha \beta}{(\alpha+\beta)^2(\alpha+\beta+1)}$`

实际上beta分布就是某个服从二项分布的随机变量，成功`$\alpha-1$`次，失败`$\beta-1$`次时，对成功的概率P的似然函数做了标准化，使之成为合法的概率密度函数。

设成功的概率为`$x$`,则出现`$\alpha-1$`次成功，`$\beta-1$`次失败的概率是：
```math
C_{\alpha+\beta-2}^{\alpha-1}x^{\alpha-1}(1-x)^{\beta-1}
```
标准化后：
```math
\begin{aligned}
&\frac{C_{\alpha+\beta-2}^{\alpha-1}x^{\alpha-1}(1-x)^{\beta-1}}{\int_0^1C_{\alpha+\beta-2}^{\alpha-1}x^{\alpha-1}(1-x)^{\beta-1}dx}\\
\\=&\frac{x^{\alpha-1}(1-x)^{\beta-1}}{\int_0^1t^{\alpha-1}(1-t)^{\beta-1}dt}\\
\\=& \frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha,\beta)}
\end{aligned}
```

## 狄利克雷分布

```math
\text{Dirichlet}(q\mid \alpha) = \frac{\Gamma(\alpha_0)}{\Gamma(\alpha_1)\Gamma(\alpha_2)\cdots\Gamma(\alpha_K)}\prod\limits_{i=1}^{K}q_i^{\alpha_i-1}
```
其中，`$\alpha_0 = \sum\limits_i\alpha_i$`


## t分布

**定理：**
设随机变量`$X,Y$`相互独立，`$X\sim N(0,1), Y\sim\chi^2(n)$`，则随机变量：
```math
T = \frac{X}{\sqrt{Y/n}}
```
服从自由度为`$n$`的`$t$`分布。

## F分布
**定理：**
设随机变量`$X,Y$`相互独立，`$X\sim\chi^2(n_1), Y\sim\chi^2(n_2)$`，则随机变量`$F$`
```math
F = \frac{\sqrt{X/n_1}}{\sqrt{Y/n_2}}
```
服从第一自由度为`$n_1$`，第二自由度为`$n_2$`的`$F$`分布。


## 共轭分布
在贝叶斯统计中，如果先验分布与后验分布是同类，则先验分布与后验分布被称为共轭分布，而先验分布被称为似然函数的共轭先验。具体的讲，就是给定贝叶斯公式
```math
p(x\mid \theta) = \frac{p(x\mid\theta)p(\theta)}{\int p(x\mid\theta')p(\theta')\,\text d\theta'}
```
似然函数是已知的，问题就是选取什么样的先验分布`$p(\theta)$`会让先验分布与后验分布具有相同的数学形式。


